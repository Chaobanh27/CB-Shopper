<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <title>Cart</title>
    <link rel="stylesheet" href="/css/style.css" />
  </head>
  <body>
    <!-- scroll to top -->
    <div class="scrollToTop-container">
      <p id="btn-text">click me to go up</p>
      <button id="btn">
        <i class="fa-solid fa-arrow-up-from-bracket fa-xl"></i>
      </button>
    </div>
    <!-- scroll to top -->

    <!-- pre-navbar start -->
    <section class="pre-navbar">
      <div class="container">
        <div class="support col-lg-6">
          <i style="color: Tomato" class="fa-solid fa-headset red"></i
          ><span> Support (00) 33 169 7720</span>
        </div>
        <div class="language col-lg-6">
          <a href=""
            ><i
              style="color: Tomato"
              class="fa-solid fa-location-crosshairs"
            ></i
            ><span> Order Tracking</span></a
          >
        </div>
      </div>
    </section>
    <!-- pre-navbar end -->

    <!-- nav start -->
    <nav
      id="navbar"
      class="navbar navbar-expand-lg position-fixed navbar-light bg-light w-100"
    >
      <div class="container">
        <a class="navbar-brand me-auto" href="/index.html">CB-Shop</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="offcanvas"
          data-bs-target="#offcanvasNavbar"
          aria-controls="offcanvasNavbar"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div
          class="offcanvas offcanvas-start"
          data-bs-scroll="true"
          tabindex="-1"
          id="offcanvasNavbar"
          aria-labelledby="offcanvasNavbarLabel"
        >
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="offcanvasNavbarLabel">Menu</h5>
            <button
              type="button"
              class="btn-close text-reset"
              data-bs-dismiss="offcanvas"
              aria-label="Close"
            ></button>
          </div>
          <div class="offcanvas-body">
            <ul class="navbar-nav ms-auto">
              <li class="nav-item">
                <a class="nav-link" href="/index.html">Home</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/shop.html">Shop</a>
              </li>
              <li class="nav-item dropdown mega-dropdown">
                <a
                  class="nav-link dropdown-toggle"
                  href="#"
                  id="navbarDropdown"
                  role="button"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                >
                  Lists
                </a>
                <div
                  class="dropdown-menu mega-dropdown-menu"
                  aria-labelledby="navbarDropdown"
                >
                  <div class="container">
                    <div class="row">
                      <div class="col-lg-3 col-sm-6 mb-3">
                        <img src="/assets/images/navbar/01.jpg" alt="" />
                        <h5 class="mt-2">Clothing</h5>
                        <ul class="list-unstyled">
                          <li><a href="/shop.html">Woman's clothing</a></li>
                          <li><a href="/shop.html">Man's clothing</a></li>
                          <li><a href="/shop.html">Kid's clothing</a></li>
                        </ul>
                      </div>
                      <div class="col-lg-3 col-sm-6 mb-3">
                        <img src="/assets/images/navbar/02.jpg" alt="" />
                        <h5 class="mt-2">Shoes</h5>
                        <ul class="list-unstyled">
                          <li><a href="/shop.html">Woman's shoes</a></li>
                          <li><a href="/shop.html">Man's shoes</a></li>
                          <li><a href="/shop.html">Kid's shoes</a></li>
                        </ul>
                      </div>
                      <div class="col-lg-3 col-sm-6 mb-3">
                        <img src="/assets/images/navbar/03.jpg" alt="" />
                        <h5 class="mt-2">Accessories</h5>
                        <ul class="list-unstyled">
                          <li><a href="/shop.html">Glasses</a></li>
                          <li><a href="/shop.html">Handbags</a></li>
                          <li><a href="/shop.html">Wallets</a></li>
                        </ul>
                      </div>
                      <div class="col-lg-3 col-sm-6 mb-3">
                        <img src="/assets/images/navbar/04.jpg" alt="" />
                        <h5 class="mt-2">Gadgets</h5>
                        <ul class="list-unstyled">
                          <li><a href="/shop.html">Hair dryer</a></li>
                          <li><a href="/shop.html">Led mirror</a></li>
                          <li><a href="/shop.html">Therapy mask</a></li>
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/about.html">About</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="contact.html">Contact</a>
              </li>
              <li class="nav-item">
                <a class="nav-link position-relative" href="/cart.html"
                  >Cart
                  <span id="total-quantity" class="text-primary">0</span>
                </a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </nav>
    <!-- nav end -->
    <section class="shopping-cart mt-5">
      <div class="container">
        <div class="table-responsive cart_info">
          <table class="table">
            <thead>
              <tr class="cart-menu">
                <td class="image">ITEM</td>
                <td class="description">NAME</td>
                <td class="price">PRICE</td>
                <td class="quantity">QUANTITY</td>
                <td class="total">TOTAL</td>
                <td class="action">REMOVE</td>
              </tr>
            </thead>
            <tbody class="table-body"></tbody>
          </table>
          <div class="summary">
            <h2>Total <span id="sum"></span></h2>
          </div>
        </div>
      </div>
    </section>

    <!-- footer start -->
    <footer class="text-center text-lg-start">
      <section
        class="footer-info d-flex justify-content-center justify-content-lg-between p-4"
      >
        <div class="footer-left-text me-5 d-none d-lg-block">
          <span>Our social network : </span>
        </div>

        <div class="footer-right-info">
          <a href="" class="me-4">
            <i class="fa-brands fa-facebook"></i>
          </a>
          <a href="" class="me-4">
            <i class="fa-brands fa-instagram"></i>
          </a>
          <a href="" class="me-4">
            <i class="fa-brands fa-linkedin"></i>
          </a>
          <a href="" class="me-4">
            <i class="fa-brands fa-github"></i>
          </a>
        </div>
      </section>

      <section class="">
        <div class="container text-center text-md-start mt-5">
          <div class="row mt-3">
            <div class="col-md-3 col-lg-4 col-xl-3 mx-auto mb-4">
              <h6 class="text-uppercase fw-bold mb-4">CB-Shop</h6>
              <p>
                Lorem Ipsum is simply dummy text of the printing and typesetting
                industry. Lorem Ipsum has been the industry's standard dummy
                text
              </p>
            </div>

            <div class="col-md-2 col-lg-2 col-xl-2 mx-auto mb-4">
              <h6 class="text-uppercase fw-bold mb-4">Clothing</h6>
              <p>
                <a href="/shop.html">Woman's clothing</a>
              </p>
              <p>
                <a href="/shop.html">Man's clothing</a>
              </p>
              <p>
                <a href="/shop.html">Kid's clothing</a>
              </p>
            </div>

            <div class="col-md-3 col-lg-2 col-xl-2 mx-auto mb-4">
              <h6 class="text-uppercase fw-bold mb-4">List</h6>
              <p>
                <a href="/shop.html">Clothing</a>
              </p>
              <p>
                <a href="/shop.html">Shoes</a>
              </p>
              <p>
                <a href="/shop.html">Accessories</a>
              </p>
              <p>
                <a href="/shop.html">Gadgets</a>
              </p>
            </div>

            <div class="col-md-4 col-lg-3 col-xl-3 mx-auto mb-md-0 mb-4">
              <h6 class="text-uppercase fw-bold mb-4">Contact</h6>
              <p><i class="fas fa-home me-3"></i> 38 Wall St</p>
              <p><i class="fas fa-envelope me-3"></i>CBShopper@gmail.com</p>
              <p><i class="fas fa-phone me-3"></i>0123456789</p>
              <p><i class="fas fa-print me-3"></i>03618294</p>
            </div>
          </div>
        </div>
      </section>

      <div
        class="text-center p-4"
        style="background-color: rgba(0, 0, 0, 0.05)"
      >
        © 2023 Copyright: Nguyen Chanh Bao
      </div>
    </footer>
    <!-- footer end -->

    <script src="/js/index.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      $(document).ready(function () {
        let sum = 0;
        let productsTemp = {};

        let totalQuantity;
        let totalQuantityCheck = localStorage.getItem("total-quantity");
        if (totalQuantityCheck != null) {
          totalQuantity = parseInt(JSON.parse(totalQuantityCheck));
          $("#total-quantity").text(totalQuantity);
        }

        let productGet = localStorage.getItem("products");
        if (productGet != null) {
          let products = JSON.parse(productGet);
          Object.keys(products).map(function (key, index) {
            let html = `
                <tr class="cart-products" id=${key}>
                    <td class="cart-image">
                      <a href=""><img src="${
                        products[key]["image"]
                      }" alt=""></a>
                    </td>
                    <td class="cart-description">
                      <h4><a href="">${products[key]["name"]}</a></h4>
                      <p>ID:${key}</p>
                    </td>
                    <td class="cart-price">
                      <p>${products[key]["price"]}</p>
                    </td>
                    <td class="cart-quantity">
                      <div class="cart-quantity-button">
                        <button class="cart-quantity-up btn btn-primary" href=""><i class="fa-solid fa-plus"></i></button>
                        <input readonly class="cart-quantity-input" type="text" name="quantity" value="${
                          products[key]["qty"]
                        }" autocomplete="off" size="1">
                        <button class="cart-quantity-down btn btn-primary" href=""><i class="fa-solid fa-minus"></i></button>
                      </div>
                    </td>
                    <td class="cart-total">
                      <p class="cart-total-price">${
                        "$" +
                        products[key]["qty"] *
                          parseInt(products[key]["price"].substring(1))
                      }</p>
                    </td>
                    <td class="cart-delete">
                      <button class="btn btn-danger cart-quantity-delete" href=""><i class="fa fa-times"></i></button>
                    </td>
                </tr>
                `;
            $("tbody").append(html);
            sum =
              sum +
              products[key]["qty"] *
                parseInt(products[key]["price"].substring(1));
          });
          $("#sum").html("$" + sum);

          $(".cart-quantity-delete").click(function () {
            let productId = $(this).closest("tr").attr("id");
            let sumTotal = parseInt($("#sum").html().substring(1));
            let cartQtyInputVal = parseInt(
              $(this).closest("div").find("input").attr("value")
            );
            let cartTotalPrice = parseInt(
              $(this)
                .closest("tr")
                .find(".cart-total-price")
                .html()
                .substring(1)
            );
            $(this).closest("tr").remove();
            delete products[productId];
            let productsSet = JSON.stringify(products);
            localStorage.setItem("products", productsSet);
            $("#sum").html("$" + (sumTotal - cartTotalPrice));

            totalQuantity = totalQuantity - cartQtyInputVal;
            $("#total-quantity").text(totalQuantity);
            let totalQuantityJson = JSON.stringify(totalQuantity);
            localStorage.setItem("total-quantity", totalQuantityJson);
          });

          $(".cart-quantity-up").click(function () {
            let productId = $(this).closest("tr").attr("id");
            let cartPrice = parseInt(
              $(this).closest("tr").find(".cart-price p").html().substring(1)
            );
            let cartQtyInputVal = parseInt(
              $(this).closest("div").find("input").attr("value")
            );
            let cartTotalPrice = parseInt(
              $(this)
                .closest("tr")
                .find(".cart-total-price")
                .html()
                .substring(1)
            );
            cartQtyInputVal = products[productId]["qty"] + 1;
            $(this).closest("div").find("input").val(cartQtyInputVal);
            $(this)
              .closest("tr")
              .find(".cart-total-price")
              .html("$" + cartQtyInputVal * cartPrice);
            products[productId]["qty"] = cartQtyInputVal;
            let productsSet = JSON.stringify(products);
            localStorage.setItem("products", productsSet);
            let sumTotal = parseInt($("#sum").html().substring(1));
            $("#sum").html("$" + (sumTotal + cartPrice));

            totalQuantity = totalQuantity + 1;
            $("#total-quantity").text(totalQuantity);
            let totalQuantityJson = JSON.stringify(totalQuantity);
            localStorage.setItem("total-quantity", totalQuantityJson);
          });

          $(".cart-quantity-down").click(function () {
            let productId = $(this).closest("tr").attr("id");
            let cartPrice = parseInt(
              $(this).closest("tr").find(".cart-price p").html().substring(1)
            );
            let cartQtyInputVal = parseInt(
              $(this).closest("div").find("input").attr("value")
            );
            let cartTotalPrice = parseInt(
              $(this)
                .closest("tr")
                .find(".cart-total-price")
                .html()
                .substring(1)
            );
            cartQtyInputVal = products[productId]["qty"] - 1;
            $(this).closest("div").find("input").val(cartQtyInputVal);
            $(this)
              .closest("tr")
              .find(".cart-total-price")
              .html("$" + cartQtyInputVal * cartPrice);
            products[productId]["qty"] = cartQtyInputVal;
            if (cartQtyInputVal < 1) {
              $(this).closest("tr").remove();
              delete products[productId];
            }
            let productsSet = JSON.stringify(products);
            localStorage.setItem("products", productsSet);
            let sumTotal = parseInt($("#sum").html().substring(1));
            $("#sum").html("$" + (sumTotal - cartPrice));

            totalQuantity = totalQuantity - 1;
            $("#total-quantity").text(totalQuantity);
            let totalQuantityJson = JSON.stringify(totalQuantity);
            localStorage.setItem("total-quantity", totalQuantityJson);
          });
        }

        //navbar start
        $(window).scroll(() => {
          if ($(window).scrollTop() > 10) {
            $("#navbar").addClass("navbar-top");
          } else {
            $("#navbar").removeClass("navbar-top");
          }
        });
        //navbar end
      });

      //scroll to top start
      const scrollBtn = document.getElementById("btn");
      const btnText = document.getElementById("btn-text");
      scrollBtn.addEventListener("click", () => {
        window.scrollTo({
          top: 0,
          left: 0,
          behavior: "smooth",
        });
      });

      window.addEventListener("scroll", () => {
        scrollBtn.style.display = window.scrollY > 200 ? "block" : "none";
      });

      scrollBtn.addEventListener("mouseover", () => {
        btnText.style.display = "block";
      });
      scrollBtn.addEventListener("mouseleave", () => {
        btnText.style.display = "none";
      });
      //scroll to top end
    </script>
  </body>
</html>
